/*!
 * jquery.lightbox.js
 * https://github.com/duncanmcdougall/Responsive-Lightbox
 * Copyright 2013 Duncan McDougall and other contributors; @license Creative Commons Attribution 2.5
 *
 * Options: 
 * margin - int - default 50. Minimum margin around the image
 * nav - bool - default true. enable navigation
 * blur - bool - default true. Blur other content when open using css filter
 * minSize - int - default 0. Min window width or height to open lightbox. Below threshold will open image in a new tab.
 *
 */
(function(e){"use strict";e.fn.lightbox=function(t){var n={margin:50,nav:true,blur:true,minSize:0};var r={items:[],lightbox:null,image:null,current:null,locked:false,selector:"#lightbox",init:function(t){r.items=t;r.selector="lightbox-"+Math.random().toString().replace(".","");if(!r.lightbox){e("body").append('<div id="lightbox" class='+r.selector+' style="display:none;">'+'<a href="#" class="lightbox-close lightbox-button"></a>'+'<div class="lightbox-nav">'+'<a href="#" class="lightbox-previous lightbox-button"></a>'+'<a href="#" class="lightbox-next lightbox-button"></a>'+"</div>"+"</div>");r.lightbox=e("."+r.selector)}if(r.items.length>1&&n.nav){e(".lightbox-nav",r.lightbox).show()}else{e(".lightbox-nav",r.lightbox).hide()}r.bindEvents()},loadImage:function(){if(n.blur){e("body").addClass("blurred")}e("img",r.lightbox).remove();r.lightbox.fadeIn("fast").append('<span class="lightbox-loading"></span>');var t=e('<img src="'+e(r.current).attr("href")+'" draggable="false">');e(t).load(function(){e(".lightbox-loading").remove();r.lightbox.append(t);r.image=e("img",r.lightbox).hide();r.resizeImage()})},resizeImage:function(){var t,i,s,o,u;i=e(window).height()-n.margin;s=e(window).outerWidth(true)-n.margin;r.image.width("").height("");o=r.image.height();u=r.image.width();if(u>s){t=s/u;u=s;o=Math.round(o*t)}if(o>i){t=i/o;o=i;u=Math.round(u*t)}r.image.width(u).height(o).css({top:(e(window).height()-r.image.outerHeight())/2+"px",left:(e(window).width()-r.image.outerWidth())/2+"px"}).show();r.locked=false},getCurrentIndex:function(){return e.inArray(r.current,r.items)},next:function(){if(r.locked){return false}r.locked=true;if(r.getCurrentIndex()>=r.items.length-1){e(r.items[0]).click()}else{e(r.items[r.getCurrentIndex()+1]).click()}},previous:function(){if(r.locked){return false}r.locked=true;if(r.getCurrentIndex()<=0){e(r.items[r.items.length-1]).click()}else{e(r.items[r.getCurrentIndex()-1]).click()}},bindEvents:function(){e(r.items).click(function(t){if(!e("#lightbox").is(":visible")&&(e(window).width()<n.minSize||e(window).height()<n.minSize)){e(this).attr("target","_blank");return}var i=e(this)[0];t.preventDefault();r.current=i;r.loadImage();e(document).on("keydown",function(e){if(e.keyCode===27){r.close()}if(e.keyCode===39){r.next()}if(e.keyCode===37){r.previous()}})});r.lightbox.on("click",function(e){if(this===e.target){r.close()}});e(r.lightbox).on("click",".lightbox-previous",function(){r.previous();return false});e(r.lightbox).on("click",".lightbox-next",function(){r.next();return false});e(r.lightbox).on("click",".lightbox-close",function(){r.close();return false});e(window).resize(function(){if(!r.image){return}r.resizeImage()})},close:function(){e(document).off("keydown");e(r.lightbox).fadeOut("fast");e("body").removeClass("blurred")}};e.extend(n,t);r.init(this)}})(jQuery)
